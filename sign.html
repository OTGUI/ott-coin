<!DOCTYPE html>
<html>
<head><title>Sign Merkle Tree TX</title>
<script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.min.js"></script>
<style>
body{font-family:sans-serif;max-width:600px;margin:50px auto;text-align:center;background:#1a1a2e;color:white}
button{background:#ff6b35;color:white;border:none;padding:15px 30px;font-size:18px;border-radius:10px;cursor:pointer;margin:10px}
button:hover{background:#e55a2b}
.info{background:#2a2a4e;padding:15px;border-radius:10px;margin:10px;word-break:break-all;font-size:12px}
#status{margin-top:20px;font-size:16px}
a{color:#ff6b35}
</style>
</head>
<body>
<h1>ğŸ Create $OTT Merkle Tree</h1>
<p>Depth: 14 | Capacity: 16,384 NFTs</p>
<div class="info"><b>Tree Address:</b><br>2AbJRFmqj3YSD9HxfbJ2ie8CrdwYDosAWUCfNrqxtfWe</div>
<button id="signBtn" onclick="signTx()">Sign with Phantom ğŸ”‘</button>
<p id="status"></p>
<script>
const txBase64 = `AQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAIH`;

async function signTx() {
  const status = document.getElementById('status');
  const btn = document.getElementById('signBtn');
  
  try {
    // Check Phantom
    const provider = window.phantom?.solana;
    if (!provider?.isPhantom) {
      status.textContent = 'âŒ Phantom wallet not found! Please install Phantom.';
      return;
    }
    
    // Connect
    status.textContent = 'ğŸ”„ Connecting to Phantom...';
    const resp = await provider.connect();
    status.textContent = 'ğŸ”„ Connected! Please approve the transaction...';
    
    // Decode base64 transaction
    const response = await fetch('https://raw.githubusercontent.com/OTGUI/ott-coin/main/tx_data.txt');
    const txData = await response.text();
    const txBytes = Uint8Array.from(atob(txData.trim()), c => c.charCodeAt(0));
    
    // Deserialize and sign
    const tx = solanaWeb3.Transaction.from(txBytes);
    const signedTx = await provider.signTransaction(tx);
    
    status.textContent = 'ğŸ”„ Sending transaction...';
    
    // Send
    const connection = new solanaWeb3.Connection('https://api.mainnet-beta.solana.com', 'confirmed');
    const signature = await connection.sendRawTransaction(signedTx.serialize());
    
    status.textContent = 'ğŸ”„ Confirming...';
    await connection.confirmTransaction(signature, 'confirmed');
    
    status.innerHTML = 'âœ… Merkle Tree Created!<br><a href="https://solscan.io/tx/' + signature + '" target="_blank">View on Solscan</a>';
    btn.style.display = 'none';
    
  } catch(e) {
    status.textContent = 'âŒ Error: ' + e.message;
    console.error(e);
  }
}
</script>
</body></html>
